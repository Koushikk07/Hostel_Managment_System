<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Announcements</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f2f6ff;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      background-color: #003366;
      color: white;
      padding: 15px;
    }
    .announcement-box {
      background-color: white;
      margin: 20px auto;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      width: 80%;
    }
    .announcement-box h3 {
      color: #003366;
      margin-bottom: 5px;
    }
    .announcement-box p {
      color: #333;
      margin: 0;
    }
    header {
  background: #007bff;
  color: white;
  padding: 16px 24px;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
}
header h1 {
  margin: 0;
  font-size: 24px;
  flex: 1;
  text-align: center;
}
header a {
  position: absolute;
  left: 24px;
  top: 50%;
  transform: translateY(-50%);
  text-decoration: none;
  background: white;
  color: #007bff;
  padding: 8px 16px;
  border-radius: 6px;
  font-weight: bold;
  transition: background 0.3s, color 0.3s;
}
header a:hover {
  background: #0056b3;
 color:Â white;
}
  </style>
</head>
<body>

  <header>
    <h1>Hostel Announcements</h1>
    <a href="dashboard.html">back</a>
  </header>


<script>
  const announcementsContainer = document.getElementById('announcement-list'); // Assuming your container div has this ID

// Fetch and render announcements for the student
async function fetchAndRenderAnnouncements() {
    try {
        const response = await fetch('/api/announcements');
        const data = await response.json();
        
        if (data.success) {
            renderStudentAnnouncements(data.announcements);
        } else {
            console.error('Failed to fetch announcements:', data.message);
            // Fallback for students
            document.body.innerHTML += `<div style="text-align:center; color:red;">Error loading notices: ${data.message}</div>`;
        }
    } catch (error) {
        console.error('Network error fetching announcements:', error);
        document.body.innerHTML += `<div style="text-align:center; color:red;">Network Error. Could not connect to server.</div>`;
    }
}

// Renders the list of announcements for the student
function renderStudentAnnouncements(announcements) {
    // Find the current container in your HTML structure
    let container = document.body; // Or find the specific container like: document.getElementById('main-content');
    
    // Since announcements.html shows placeholder divs, we'll replace the content.
    // Assuming you have a main container that holds the announcement boxes.
    // If your original HTML had placeholder boxes, remove them first.
    
    // Using a new container element for clarity:
    const newContainer = document.createElement('div');
    newContainer.className = 'container'; 
    newContainer.style.width = '80%';
    newContainer.style.margin = '20px auto';
    
    if (announcements.length === 0) {
        newContainer.innerHTML = '<p style="text-align:center;">No official announcements at this time.</p>';
        container.appendChild(newContainer);
        return;
    }

    announcements.forEach(ann => {
        const date = new Date(ann.created_at).toLocaleDateString();
        const box = document.createElement('div');
        box.classList.add('announcement-box');
        box.innerHTML = `
            <h3>${ann.title}</h3>
            <p>${ann.message}</p>
            <small style="color: #666;">Posted on: ${date}</small>
        `;
        newContainer.appendChild(box);
    });
    
    // Assuming the original content (like h1) is already there, we append the dynamic content
    document.body.appendChild(newContainer); 
}

// Initial load when the page is ready
document.addEventListener('DOMContentLoaded', fetchAndRenderAnnouncements);
</script>
</body>
</html>
